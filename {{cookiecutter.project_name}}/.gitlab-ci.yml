image: "python:{{cookiecutter.python_version}}-buster"

stages:
  - tox
  - package
  - pages

tox:
  stage: tox
  script:
    - pip install tox
    - tox
  artifacts:
    paths:
      - docs/_build

package:
  stage: package
  script:
    - pip install setuptools wheel
    - python setup.py sdist bdist_wheel
  artifacts:
    paths:
      - dist/*.whl

pages:
  stage: pages
  dependencies:
    - tox
  script:
    - mkdir -p public
    - mv docs/_build/html/* public
  artifacts:
    paths:
    - public
  only:
    - develop
